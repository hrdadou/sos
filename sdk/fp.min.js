function t(t, e) {
    var n = (65535 & t) + (65535 & e);
    return (t >> 16) + (e >> 16) + (n >> 16) << 16 | 65535 & n;
}

function e(t, e) {
    return t << e | t >>> 32 - e;
}

function n(n, o, r, i, c, a) {
    return t(e(t(t(o, n), t(i, a)), c), r);
}

function o(t, e, o, r, i, c, a) {
    return n(e & o | ~e & r, t, e, i, c, a);
}

function r(t, e, o, r, i, c, a) {
    return n(e & r | o & ~r, t, e, i, c, a);
}

function i(t, e, o, r, i, c, a) {
    return n(e ^ o ^ r, t, e, i, c, a);
}

function c(t, e, o, r, i, c, a) {
    return n(o ^ (e | ~r), t, e, i, c, a);
}

function a(e, n) {
    e[n >> 5] |= 128 << n % 32, e[14 + (n + 64 >>> 9 << 4)] = n;
    var a = void 0, u = void 0, s = void 0, d = void 0, f = void 0, h = 1732584193, v = -271733879, l = -1732584194, m = 271733878;
    for (a = 0; a < e.length; a += 16) u = h, s = v, d = l, f = m, v = c(v = c(v = c(v = c(v = i(v = i(v = i(v = i(v = r(v = r(v = r(v = r(v = o(v = o(v = o(v = o(v, l = o(l, m = o(m, h = o(h, v, l, m, e[a], 7, -680876936), v, l, e[a + 1], 12, -389564586), h, v, e[a + 2], 17, 606105819), m, h, e[a + 3], 22, -1044525330), l = o(l, m = o(m, h = o(h, v, l, m, e[a + 4], 7, -176418897), v, l, e[a + 5], 12, 1200080426), h, v, e[a + 6], 17, -1473231341), m, h, e[a + 7], 22, -45705983), l = o(l, m = o(m, h = o(h, v, l, m, e[a + 8], 7, 1770035416), v, l, e[a + 9], 12, -1958414417), h, v, e[a + 10], 17, -42063), m, h, e[a + 11], 22, -1990404162), l = o(l, m = o(m, h = o(h, v, l, m, e[a + 12], 7, 1804603682), v, l, e[a + 13], 12, -40341101), h, v, e[a + 14], 17, -1502002290), m, h, e[a + 15], 22, 1236535329), l = r(l, m = r(m, h = r(h, v, l, m, e[a + 1], 5, -165796510), v, l, e[a + 6], 9, -1069501632), h, v, e[a + 11], 14, 643717713), m, h, e[a], 20, -373897302), l = r(l, m = r(m, h = r(h, v, l, m, e[a + 5], 5, -701558691), v, l, e[a + 10], 9, 38016083), h, v, e[a + 15], 14, -660478335), m, h, e[a + 4], 20, -405537848), l = r(l, m = r(m, h = r(h, v, l, m, e[a + 9], 5, 568446438), v, l, e[a + 14], 9, -1019803690), h, v, e[a + 3], 14, -187363961), m, h, e[a + 8], 20, 1163531501), l = r(l, m = r(m, h = r(h, v, l, m, e[a + 13], 5, -1444681467), v, l, e[a + 2], 9, -51403784), h, v, e[a + 7], 14, 1735328473), m, h, e[a + 12], 20, -1926607734), l = i(l, m = i(m, h = i(h, v, l, m, e[a + 5], 4, -378558), v, l, e[a + 8], 11, -2022574463), h, v, e[a + 11], 16, 1839030562), m, h, e[a + 14], 23, -35309556), l = i(l, m = i(m, h = i(h, v, l, m, e[a + 1], 4, -1530992060), v, l, e[a + 4], 11, 1272893353), h, v, e[a + 7], 16, -155497632), m, h, e[a + 10], 23, -1094730640), l = i(l, m = i(m, h = i(h, v, l, m, e[a + 13], 4, 681279174), v, l, e[a], 11, -358537222), h, v, e[a + 3], 16, -722521979), m, h, e[a + 6], 23, 76029189), l = i(l, m = i(m, h = i(h, v, l, m, e[a + 9], 4, -640364487), v, l, e[a + 12], 11, -421815835), h, v, e[a + 15], 16, 530742520), m, h, e[a + 2], 23, -995338651), l = c(l, m = c(m, h = c(h, v, l, m, e[a], 6, -198630844), v, l, e[a + 7], 10, 1126891415), h, v, e[a + 14], 15, -1416354905), m, h, e[a + 5], 21, -57434055), l = c(l, m = c(m, h = c(h, v, l, m, e[a + 12], 6, 1700485571), v, l, e[a + 3], 10, -1894986606), h, v, e[a + 10], 15, -1051523), m, h, e[a + 1], 21, -2054922799), l = c(l, m = c(m, h = c(h, v, l, m, e[a + 8], 6, 1873313359), v, l, e[a + 15], 10, -30611744), h, v, e[a + 6], 15, -1560198380), m, h, e[a + 13], 21, 1309151649), l = c(l, m = c(m, h = c(h, v, l, m, e[a + 4], 6, -145523070), v, l, e[a + 11], 10, -1120210379), h, v, e[a + 2], 15, 718787259), m, h, e[a + 9], 21, -343485551), 
    h = t(h, u), v = t(v, s), l = t(l, d), m = t(m, f);
    return [ h, v, l, m ];
}

function u(t) {
    var e = void 0, n = "", o = 32 * t.length;
    for (e = 0; e < o; e += 8) n += String.fromCharCode(255 & t[e >> 5] >>> e % 32);
    return n;
}

function s(t) {
    var e = void 0, n = [];
    for (n[(t.length >> 2) - 1] = void 0, e = 0; e < n.length; e += 1) n[e] = 0;
    var o = 8 * t.length;
    for (e = 0; e < o; e += 8) n[e >> 5] |= (255 & t.charCodeAt(e / 8)) << e % 32;
    return n;
}

function d(t) {
    return u(a(s(t), 8 * t.length));
}

function f(t) {
    var e = void 0, n = void 0, o = "0123456789abcdef", r = "";
    for (n = 0; n < t.length; n += 1) e = t.charCodeAt(n), r += o.charAt(15 & e >>> 4) + o.charAt(15 & e);
    return r;
}

function h(t) {
    return unescape(encodeURIComponent(t));
}

function v(t) {
    return d(h(t));
}

function l(t) {
    return f(v(t));
}

function m(t) {
    return l(t);
}

function g(t) {
    t = unescape(t);
    for (var e = String.fromCharCode, n = e(t.charCodeAt(0) - t.length), o = 1; o < t.length; o++) n += e(t.charCodeAt(o) - n.charCodeAt(o - 1));
    return n;
}

function p() {
    var t = new Date(), e = t.getFullYear().toString(), n = (t.getMonth() + 1).toString(), o = t.getDate().toString(), r = t.getHours().toString(), i = t.getMinutes().toString(), c = t.getSeconds().toString();
    return n = 9 >= n ? "0" + n : n, o = 9 >= o ? "0" + o : o, r = 9 >= r ? "0" + r : r, 
    i = 9 >= i ? "0" + i : i, c = 9 >= c ? "0" + c : c, e + n + o + r + i + c;
}

function A() {
    return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function(t) {
        var e = 0 | 16 * Math.random();
        return ("x" == t ? e : 8 | 3 & e).toString(16);
    });
}

function x() {
    var t = wx.getSystemInfoSync(), e = +new Date(), n = y(), o = t.version;
    return delete t.version, Object.assign({
        channel: K.channel,
        deviceId: n,
        time: e - $,
        sessionId: tt,
        version: G,
        weAppVerion: o,
        res: t.screenWidth + "_" + t.screenHeight
    }, t);
}

function C(t) {
    var e = [];
    for (var n in t) if (t.hasOwnProperty(n)) {
        var o = t[n];
        "object" == V(t[n]) && (o = JSON.stringify(o)), e.push(n + "=" + encodeURIComponent(o));
    }
    return e.join("&");
}

function w() {
    return {
        deviceId: y(),
        time: +new Date() - $,
        sid: tt,
        version: G
    };
}

function y() {
    var t = void 0;
    try {
        var e = wx.env.USER_DATA_PATH + "/SMFP.txt";
        t = wx.getFileSystemManager().readFileSync(e, "utf8");
    } catch (t) {}
    try {
        t = wx.getStorageSync(Y, null);
    } catch (t) {}
    return t || (t = Q), S(t), t;
}

function S(t) {
    try {
        wx.env.USER_DATA_PATH, wx.getFileSystemManager();
        wx.setStorageSync(Y, t);
    } catch (t) {}
    try {
        fs.writeFileSync(FILEPATH, t, "utf8");
    } catch (t) {}
}

function I() {
    return new Promise(function(t) {
        wx.getLocation({
            altitude: !0,
            success: function(e) {
                t(e);
            },
            fail: function() {
                t({});
            }
        });
    });
}

function b() {
    return new Promise(function(t) {
        var e = [];
        wx.onAccelerometerChange(function(n) {
            e.push(n), setTimeout(function() {
                wx.stopAccelerometer();
            }, 6e3), t(e);
        }), setTimeout(function() {
            t([]);
        }, 1e3);
    });
}

function D() {
    return new Promise(function(t) {
        var e = [];
        wx.onCompassChange(function(n) {
            e.push(n.direction), setTimeout(function() {
                wx.stopCompass();
            }, 6e3), t(e);
        }), setTimeout(function() {
            t([]);
        }, 1e3);
    });
}

function k() {
    return new Promise(function(t) {
        var e = x();
        wx.startWifi({
            success: function() {
                "android" == e.platform ? wx.getWifiList({
                    success: function() {
                        wx.onGetWifiList(function(e) {
                            wx.stopWifi(), t(e.wifiList);
                        }), setTimeout(function() {
                            t([]);
                        }, 1e3);
                    },
                    fail: function() {
                        t([]);
                    }
                }) : t([]);
            }
        });
    });
}

function P() {
    return new Promise(function(t) {
        wx.openBluetoothAdapter({
            success: function() {
                wx.startBluetoothDevicesDiscovery({
                    success: function() {
                        var e = [], n = [];
                        wx.onBluetoothDeviceFound(function(t) {
                            for (var o = t.devices, r = 0; r < o.length; r++) -1 == n.indexOf(o[r].deviceId) && (n.push(o[r].deviceId), 
                            e.push({
                                deviceId: o[r].deviceId,
                                name: o[r].name,
                                RSSI: o[r].RSSI
                            }));
                        }), setTimeout(function() {
                            t(e);
                        }, 2e3);
                    },
                    fail: function() {
                        t([]), q();
                    }
                });
            },
            fail: function() {
                t([]), q();
            }
        });
    });
}

function T() {
    return new Promise(function(t) {
        wx.getScreenBrightness({
            success: function(e) {
                t(e.value);
            },
            fail: function() {
                t(-1);
            }
        });
    });
}

function B() {
    return new Promise(function(t) {
        wx.getNetworkType({
            success: function(e) {
                t(e.networkType);
            },
            fail: function() {
                t("");
            }
        });
    });
}

function F(t, e, n, o) {
    Z.deviceId = t, Z.sign = e, Z.timestamp = n, Z.length = 1 * o;
}

function M() {
    return {
        deviceId: Z.deviceId,
        sign: Z.sign,
        timestamp: Z.timestamp,
        length: Z.length
    };
}

function j() {
    return {
        deviceId: y(),
        sign: null,
        timestamp: X.timestamp
    };
}

function H(t, e, n) {
    wx.request({
        url: t,
        data: e,
        header: {
            "content-type": "application/json"
        },
        success: function(t) {
            var e = {
                code: 1902,
                detail: {},
                deviceId: "",
                message: "数据解析异常",
                requestId: "",
                riskLevel: ""
            }, o = /smCB\((.*)\)/, r = t.data.match(o);
            if (r) {
                var i = r[1];
                try {
                    n(JSON.parse(i));
                } catch (t) {
                    n(e);
                }
            } else n(e);
        }
    });
}

function L(t, e) {
    try {
        var n = M().timestamp;
        return E(t(e)) + n;
    } catch (t) {
        var o = j().timestamp;
        return E(O(W, e)) + o;
    }
}

function O(t, e, n, o, r, i) {
    return t = t || W, n = n || X.key, o = 0 == o ? 0 : 1, r = 2 == r ? 1 : 0, n += "", 
    0 == r ? t(n, e, o) : t(n, e, o, r, i);
}

function R(t) {
    for (var e = void 0, n = void 0, o = void 0, r = [ 0, 4, 536870912, 536870916, 65536, 65540, 536936448, 536936452, 512, 516, 536871424, 536871428, 66048, 66052, 536936960, 536936964 ], i = [ 0, 1, 1048576, 1048577, 67108864, 67108865, 68157440, 68157441, 256, 257, 1048832, 1048833, 67109120, 67109121, 68157696, 68157697 ], c = [ 0, 8, 2048, 2056, 16777216, 16777224, 16779264, 16779272, 0, 8, 2048, 2056, 16777216, 16777224, 16779264, 16779272 ], a = [ 0, 2097152, 134217728, 136314880, 8192, 2105344, 134225920, 136323072, 131072, 2228224, 134348800, 136445952, 139264, 2236416, 134356992, 136454144 ], u = [ 0, 262144, 16, 262160, 0, 262144, 16, 262160, 4096, 266240, 4112, 266256, 4096, 266240, 4112, 266256 ], s = [ 0, 1024, 32, 1056, 0, 1024, 32, 1056, 33554432, 33555456, 33554464, 33555488, 33554432, 33555456, 33554464, 33555488 ], d = [ 0, 268435456, 524288, 268959744, 2, 268435458, 524290, 268959746, 0, 268435456, 524288, 268959744, 2, 268435458, 524290, 268959746 ], f = [ 0, 65536, 2048, 67584, 536870912, 536936448, 536872960, 536938496, 131072, 196608, 133120, 198656, 537001984, 537067520, 537004032, 537069568 ], h = [ 0, 262144, 0, 262144, 2, 262146, 2, 262146, 33554432, 33816576, 33554432, 33816576, 33554434, 33816578, 33554434, 33816578 ], v = [ 0, 268435456, 8, 268435464, 0, 268435456, 8, 268435464, 1024, 268436480, 1032, 268436488, 1024, 268436480, 1032, 268436488 ], l = [ 0, 32, 0, 32, 1048576, 1048608, 1048576, 1048608, 8192, 8224, 8192, 8224, 1056768, 1056800, 1056768, 1056800 ], m = [ 0, 16777216, 512, 16777728, 2097152, 18874368, 2097664, 18874880, 67108864, 83886080, 67109376, 83886592, 69206016, 85983232, 69206528, 85983744 ], g = [ 0, 4096, 134217728, 134221824, 524288, 528384, 134742016, 134746112, 16, 4112, 134217744, 134221840, 524304, 528400, 134742032, 134746128 ], p = [ 0, 4, 256, 260, 0, 4, 256, 260, 1, 5, 257, 261, 1, 5, 257, 261 ], A = 8 < t.length ? 3 : 1, x = Array(32 * A), C = [ 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0 ], w = 0, y = 0, S = 0; S < A; S++) {
        var S = t.charCodeAt(w++) << 24 | t.charCodeAt(w++) << 16 | t.charCodeAt(w++) << 8 | t.charCodeAt(w++), I = t.charCodeAt(w++) << 24 | t.charCodeAt(w++) << 16 | t.charCodeAt(w++) << 8 | t.charCodeAt(w++);
        S ^= (o = 252645135 & (S >>> 4 ^ I)) << 4, S ^= o = 65535 & ((I ^= o) >>> -16 ^ S), 
        S ^= (o = 858993459 & (S >>> 2 ^ (I ^= o << -16))) << 2, S ^= o = 65535 & ((I ^= o) >>> -16 ^ S), 
        S ^= (o = 1431655765 & (S >>> 1 ^ (I ^= o << -16))) << 1, S ^= o = 16711935 & ((I ^= o) >>> 8 ^ S), 
        o = (S ^= (o = 1431655765 & (S >>> 1 ^ (I ^= o << 8))) << 1) << 8 | 240 & (I ^= o) >>> 20, 
        S = I << 24 | 16711680 & I << 8 | 65280 & I >>> 8 | 240 & I >>> 24, I = o;
        for (var b = 0; b < C.length; b++) C[b] ? (S = S << 2 | S >>> 26, I = I << 2 | I >>> 26) : (S = S << 1 | S >>> 27, 
        I = I << 1 | I >>> 27), I &= -15, e = r[(S &= -15) >>> 28] | i[15 & S >>> 24] | c[15 & S >>> 20] | a[15 & S >>> 16] | u[15 & S >>> 12] | s[15 & S >>> 8] | d[15 & S >>> 4], 
        o = 65535 & ((n = f[I >>> 28] | h[15 & I >>> 24] | v[15 & I >>> 20] | l[15 & I >>> 16] | m[15 & I >>> 12] | g[15 & I >>> 8] | p[15 & I >>> 4]) >>> 16 ^ e), 
        x[y++] = e ^ o, x[y++] = n ^ o << 16;
    }
    return x;
}

function W(t, e, n, o, r, i) {
    var c = String.fromCharCode, a = void 0, u = void 0, s = void 0, d = void 0, f = void 0, h = void 0, v = void 0, l = void 0, m = void 0, g = void 0, p = void 0, A = void 0, x = void 0, C = void 0, w = [ 16843776, 0, 65536, 16843780, 16842756, 66564, 4, 65536, 1024, 16843776, 16843780, 1024, 16778244, 16842756, 16777216, 4, 1028, 16778240, 16778240, 66560, 66560, 16842752, 16842752, 16778244, 65540, 16777220, 16777220, 65540, 0, 1028, 66564, 16777216, 65536, 16843780, 4, 16842752, 16843776, 16777216, 16777216, 1024, 16842756, 65536, 66560, 16777220, 1024, 4, 16778244, 66564, 16843780, 65540, 16842752, 16778244, 16777220, 1028, 66564, 16843776, 1028, 16778240, 16778240, 0, 65540, 66560, 0, 16842756 ], y = [ -2146402272, -2147450880, 32768, 1081376, 1048576, 32, -2146435040, -2147450848, -2147483616, -2146402272, -2146402304, -2147483648, -2147450880, 1048576, 32, -2146435040, 1081344, 1048608, -2147450848, 0, -2147483648, 32768, 1081376, -2146435072, 1048608, -2147483616, 0, 1081344, 32800, -2146402304, -2146435072, 32800, 0, 1081376, -2146435040, 1048576, -2147450848, -2146435072, -2146402304, 32768, -2146435072, -2147450880, 32, -2146402272, 1081376, 32, 32768, -2147483648, 32800, -2146402304, 1048576, -2147483616, 1048608, -2147450848, -2147483616, 1048608, 1081344, 0, -2147450880, 32800, -2147483648, -2146435040, -2146402272, 1081344 ], S = [ 520, 134349312, 0, 134348808, 134218240, 0, 131592, 134218240, 131080, 134217736, 134217736, 131072, 134349320, 131080, 134348800, 520, 134217728, 8, 134349312, 512, 131584, 134348800, 134348808, 131592, 134218248, 131584, 131072, 134218248, 8, 134349320, 512, 134217728, 134349312, 134217728, 131080, 520, 131072, 134349312, 134218240, 0, 512, 131080, 134349320, 134218240, 134217736, 512, 0, 134348808, 134218248, 131072, 134217728, 134349320, 8, 131592, 131584, 134217736, 134348800, 134218248, 520, 134348800, 131592, 8, 134348808, 131584 ], I = [ 8396801, 8321, 8321, 128, 8396928, 8388737, 8388609, 8193, 0, 8396800, 8396800, 8396929, 129, 0, 8388736, 8388609, 1, 8192, 8388608, 8396801, 128, 8388608, 8193, 8320, 8388737, 1, 8320, 8388736, 8192, 8396928, 8396929, 129, 8388736, 8388609, 8396800, 8396929, 129, 0, 0, 8396800, 8320, 8388736, 8388737, 1, 8396801, 8321, 8321, 128, 8396929, 129, 1, 8192, 8388609, 8193, 8396928, 8388737, 8193, 8320, 8388608, 8396801, 128, 8388608, 8192, 8396928 ], b = [ 256, 34078976, 34078720, 1107296512, 524288, 256, 1073741824, 34078720, 1074266368, 524288, 33554688, 1074266368, 1107296512, 1107820544, 524544, 1073741824, 33554432, 1074266112, 1074266112, 0, 1073742080, 1107820800, 1107820800, 33554688, 1107820544, 1073742080, 0, 1107296256, 34078976, 33554432, 1107296256, 524544, 524288, 1107296512, 256, 33554432, 1073741824, 34078720, 1107296512, 1074266368, 33554688, 1073741824, 1107820544, 34078976, 1074266368, 256, 33554432, 1107820544, 1107820800, 524544, 1107296256, 1107820800, 34078720, 0, 1074266112, 1107296256, 524544, 33554688, 1073742080, 524288, 0, 1074266112, 34078976, 1073742080 ], D = [ 536870928, 541065216, 16384, 541081616, 541065216, 16, 541081616, 4194304, 536887296, 4210704, 4194304, 536870928, 4194320, 536887296, 536870912, 16400, 0, 4194320, 536887312, 16384, 4210688, 536887312, 16, 541065232, 541065232, 0, 4210704, 541081600, 16400, 4210688, 541081600, 536870912, 536887296, 16, 541065232, 4210688, 541081616, 4194304, 16400, 536870928, 4194304, 536887296, 536870912, 16400, 536870928, 541081616, 4210688, 541065216, 4210704, 541081600, 0, 541065232, 16, 16384, 541065216, 4210704, 16384, 4194320, 536887312, 0, 541081600, 536870912, 4194320, 536887312 ], k = [ 2097152, 69206018, 67110914, 0, 2048, 67110914, 2099202, 69208064, 69208066, 2097152, 0, 67108866, 2, 67108864, 69206018, 2050, 67110912, 2099202, 2097154, 67110912, 67108866, 69206016, 69208064, 2097154, 69206016, 2048, 2050, 69208066, 2099200, 2, 67108864, 2099200, 67108864, 2099200, 2097152, 67110914, 67110914, 69206018, 69206018, 2, 2097154, 67108864, 67110912, 2097152, 69208064, 2050, 2099202, 69208064, 2050, 67108866, 69208066, 69206016, 2099200, 0, 2, 69208066, 0, 2099202, 69206016, 2048, 67108866, 67110912, 2048, 2097154 ], P = [ 268439616, 4096, 262144, 268701760, 268435456, 268439616, 64, 268435456, 262208, 268697600, 268701760, 266240, 268701696, 266304, 4096, 64, 268697600, 268435520, 268439552, 4160, 266240, 262208, 268697664, 268701696, 4160, 0, 0, 268697664, 268435520, 268439552, 266304, 262144, 266304, 262144, 268701696, 4096, 64, 268697664, 4096, 266304, 268439552, 64, 268435520, 268697600, 268697664, 268435456, 262144, 268439616, 0, 268701760, 262208, 268435520, 268697600, 268439552, 268439616, 0, 268701760, 266240, 266240, 4160, 4160, 262208, 268435456, 268701696 ], T = R(t), B = 0, F = e.length, M = 0, j = 32 == T.length ? 3 : 9;
    l = 3 == j ? n ? [ 0, 32, 2 ] : [ 30, -2, -2 ] : n ? [ 0, 32, 2, 62, 30, -2, 64, 96, 2 ] : [ 94, 62, -2, 32, 64, 2, 30, -2, -2 ], 
    2 == i ? e += "        " : 1 == i ? (s = 8 - F % 8, e += c(s, s, s, s, s, s, s, s), 
    8 == s && (F += 8)) : !i && (e += "\0\0\0\0\0\0\0\0");
    var H = "", L = "";
    for (1 == o && (m = r.charCodeAt(B++) << 24 | r.charCodeAt(B++) << 16 | r.charCodeAt(B++) << 8 | r.charCodeAt(B++), 
    p = r.charCodeAt(B++) << 24 | r.charCodeAt(B++) << 16 | r.charCodeAt(B++) << 8 | r.charCodeAt(B++), 
    B = 0); B < F; ) {
        for (h = e.charCodeAt(B++) << 24 | e.charCodeAt(B++) << 16 | e.charCodeAt(B++) << 8 | e.charCodeAt(B++), 
        v = e.charCodeAt(B++) << 24 | e.charCodeAt(B++) << 16 | e.charCodeAt(B++) << 8 | e.charCodeAt(B++), 
        1 == o && (n ? (h ^= m, v ^= p) : (g = m, A = p, m = h, p = v)), h ^= (s = 252645135 & (h >>> 4 ^ v)) << 4, 
        h ^= (s = 65535 & (h >>> 16 ^ (v ^= s))) << 16, h ^= s = 858993459 & ((v ^= s) >>> 2 ^ h), 
        h ^= s = 16711935 & ((v ^= s << 2) >>> 8 ^ h), h = (h ^= (s = 1431655765 & (h >>> 1 ^ (v ^= s << 8))) << 1) << 1 | h >>> 31, 
        v = (v ^= s) << 1 | v >>> 31, u = 0; u < j; u += 3) {
            for (x = l[u + 1], C = l[u + 2], a = l[u]; a != x; a += C) d = v ^ T[a], f = (v >>> 4 | v << 28) ^ T[a + 1], 
            s = h, h = v, v = s ^ (y[63 & d >>> 24] | I[63 & d >>> 16] | D[63 & d >>> 8] | P[63 & d] | w[63 & f >>> 24] | S[63 & f >>> 16] | b[63 & f >>> 8] | k[63 & f]);
            s = h, h = v, v = s;
        }
        v = v >>> 1 | v << 31, v ^= s = 1431655765 & ((h = h >>> 1 | h << 31) >>> 1 ^ v), 
        v ^= (s = 16711935 & (v >>> 8 ^ (h ^= s << 1))) << 8, v ^= (s = 858993459 & (v >>> 2 ^ (h ^= s))) << 2, 
        v ^= s = 65535 & ((h ^= s) >>> 16 ^ v), v ^= s = 252645135 & ((h ^= s << 16) >>> 4 ^ v), 
        h ^= s << 4, 1 == o && (n ? (m = h, p = v) : (h ^= g, v ^= A)), L += c(h >>> 24, 255 & h >>> 16, 255 & h >>> 8, 255 & h, v >>> 24, 255 & v >>> 16, 255 & v >>> 8, 255 & v), 
        512 == (M += 8) && (H += L, L = "", M = 0);
    }
    return H + L;
}

function E(t) {
    var e = void 0, n = void 0, o = void 0, r = void 0, i = void 0, c = void 0, a = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
    for (o = t.length, n = 0, e = ""; n < o; ) {
        if (r = 255 & t.charCodeAt(n++), n == o) {
            e += a.charAt(r >> 2), e += a.charAt((3 & r) << 4), e += "==";
            break;
        }
        if (i = t.charCodeAt(n++), n == o) {
            e += a.charAt(r >> 2), e += a.charAt((3 & r) << 4 | (240 & i) >> 4), e += a.charAt((15 & i) << 2), 
            e += "=";
            break;
        }
        c = t.charCodeAt(n++), e += a.charAt(r >> 2), e += a.charAt((3 & r) << 4 | (240 & i) >> 4), 
        e += a.charAt((15 & i) << 2 | (192 & c) >> 6), e += a.charAt(63 & c);
    }
    return e;
}

function _(t) {
    var e = String.fromCharCode, n = void 0, o = void 0, r = void 0, i = void 0, c = void 0, a = void 0, u = void 0, s = [ -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, -1, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, -1, -1, -1, -1, -1 ];
    for (a = t.length, c = 0, u = ""; c < a; ) {
        do {
            n = s[255 & t.charCodeAt(c++)];
        } while (c < a && -1 == n);
        if (-1 == n) break;
        do {
            o = s[255 & t.charCodeAt(c++)];
        } while (c < a && -1 == o);
        if (-1 == o) break;
        u += e(n << 2 | (48 & o) >> 4);
        do {
            if (61 == (r = 255 & t.charCodeAt(c++))) return u;
            r = s[r];
        } while (c < a && -1 == r);
        if (-1 == r) break;
        u += e((15 & o) << 4 | (60 & r) >> 2);
        do {
            if (61 == (i = 255 & t.charCodeAt(c++))) return u;
            i = s[i];
        } while (c < a && -1 == i);
        if (-1 == i) break;
        u += e((3 & r) << 6 | i);
    }
    return u;
}

function j() {
    return {
        deviceId: y(),
        sign: null,
        timestamp: X.timestamp
    };
}

function F(t, e, n, o) {
    Z.deviceId = t, Z.sign = e, Z.timestamp = n, Z.length = 1 * o;
}

function M() {
    return {
        deviceId: Z.deviceId,
        sign: Z.sign,
        timestamp: Z.timestamp,
        length: Z.length
    };
}

function U(t, e) {
    var n = M().length;
    try {
        var o = O(W, _(t), "", 0).substr(0, n).split(","), r = z(o[0]), i = null;
        return "function" == typeof r && (i = function(t) {
            return O(r, t, o[2], o[1], o[3]);
        }), "W" + L(i, e);
    } catch (t) {
        return "W" + L(W, e);
    }
}

function z(t) {
    var e = [ null, W ];
    return e[t] ? e[t] : null;
}

function N(t) {
    var e = C(t), n = "https://" + K.apiHost + K.apiPath, o = j();
    F(o.deviceId, o.sign, o.timestamp, 0), H(n, {
        organization: K.organization,
        smdata: U(o.sign, e),
        os: "weapp",
        version: G
    }, function(t) {
        if (1100 == t.code) {
            var e = t.deviceId, n = t.detail ? t.detail.timestamp : "", o = t.detail ? t.detail.sign : "", r = t.detail ? t.detail.len : 0;
            e && o && n && r && (S(e), F(e, o, n, r));
        }
    });
}

function q() {
    wx.stopBluetoothDevicesDiscovery(), wx.closeBluetoothAdapter();
}

function J(t, e) {
    return t.sort(function(t, n) {
        return 0 > t[e] - n[e];
    }).slice(0, 10);
}

var V = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(t) {
    return typeof t;
} : function(t) {
    return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
}, G = "2.0.0", Y = "smidV2", K = {
    channel: "",
    organization: "",
    apiHost: "fp-bj.fengkongcloud.com",
    apiPath: "/v2/web/profile"
}, Q = function() {
    var t = p() + m(A()) + "00";
    return t + m("smsk_web_" + t).substr(0, 14) + 0;
}(), X = {
    key: g("%5B%A0%C0%DB%DD%E2%D2%CE"),
    deviceId: Q,
    timestamp: g("%3Eelollnmmnhck")
}, Z = {
    sign: "",
    timestamp: "",
    deviceId: "",
    length: 0
}, $ = +new Date(), tt = +new Date() + "-" + Math.floor(1e8 * Math.random());

setTimeout(function() {
    N(x()), wx.startAccelerometer(), wx.startCompass();
}, 0);

var et = 0, nt = setInterval(function() {
    try {
        var t = K.authConf && 1 == K.authConf.location;
        if (3 > et) {
            var e = x(), n = [ b(), D(), T(), B(), k(), P() ];
            t && n.push(I()), Promise.all(n).then(function(n) {
                var o = {
                    accelerometer: n[0],
                    compass: n[1],
                    screenBright: n[2],
                    networkType: n[3],
                    wifiList: J(n[4], "signalStrength"),
                    bluetooth: J(n[5], "RSSI")
                }, r = Object.assign(e, o);
                t && (o.location = n[6]), N(r);
            });
        } else clearInterval(nt);
        et++;
    } catch (t) {}
}, 2e3);

module.exports = {
    initConf: function(t) {
        K = Object.assign({}, K, t);
    },
    getDeviceId: function() {
        var t = C(w());
        return U(M().sign, t);
    }
};